@import "tailwindcss";

/*
 * Nihontowatch - Theme System
 * Based on Oshi-v2 Yuhinkai design system
 *
 * Themes:
 *   - Dark mode (default): Warm scholarly blacks with steel blue accent
 *   - Light mode: Clean museum whites with gold accent
 */

/* ==========================================================================
   Light Mode (Default) - Clean scholarly whites
   ========================================================================== */
:root {
  /* Core palette */
  --background: #FAF9F6;
  --background-warm: #FEFDFB;
  --foreground: #1C1C1C;

  /* Surfaces - elevation through subtle warmth */
  --surface: #F8F6F3;
  --surface-elevated: #FFFFFF;
  --surface-overlay: rgba(248, 246, 243, 0.97);

  /* Borders */
  --border: #E8E4DE;
  --border-subtle: #F0EDE8;
  --border-accent: rgba(184, 134, 11, 0.35);

  /* Interactive states */
  --hover: #F2F0EC;
  --active: #EBE8E2;

  /* Primary accent - gold */
  --accent: #B8860B;
  --accent-light: #D4AF37;
  --accent-dark: #9A7209;
  --accent-glow: rgba(184, 134, 11, 0.18);

  /* Text hierarchy */
  --text-primary: #1C1C1C;
  --text-secondary: #4A4A4A;
  --text-tertiary: #6A6A6A;
  --text-muted: #7A7A7A;
  --text-accent: #9A7209;

  /* Semantic colors */
  --success: #5a9b7a;
  --warning: #c9a857;
  --error: #c97070;

  /* Button defaults */
  --button-bg: var(--accent);
  --button-bg-hover: var(--accent-dark);
  --button-text: #ffffff;

  /* Certification colors - light mode */
  --tokuju: #5B3D8A;
  --tokuju-bg: rgba(91, 61, 138, 0.12);
  --jubi: #D4820A;
  --jubi-bg: rgba(212, 130, 10, 0.12);
  --juyo: #2D5A8A;
  --juyo-bg: rgba(45, 90, 138, 0.12);
  --toku-hozon: #8B5A2B;
  --toku-hozon-bg: rgba(139, 90, 43, 0.12);
  --hozon: #8A7A20;
  --hozon-bg: rgba(138, 122, 32, 0.12);
  --sage: #8FA67A;

  /* New listing badge - fresh green */
  --new-listing: #2D8A5A;
  --new-listing-bg: rgba(45, 138, 90, 0.12);

  /* Artisan confidence colors (admin-only badges) */
  --artisan-high: #2D8A5A;             /* Green - matches new-listing */
  --artisan-high-bg: rgba(45, 138, 90, 0.12);
  --artisan-medium: #C9A857;           /* Yellow/amber - matches warning */
  --artisan-medium-bg: rgba(201, 168, 87, 0.12);
  --artisan-low: #6A6A6A;              /* Gray - muted for uncertainty */
  --artisan-low-bg: rgba(106, 106, 106, 0.10);

  /* Provenance tier colors — Japanese court rank palette */
  --prov-imperial: #B8860B;            /* Gold — chrysanthemum seal */
  --prov-shogunal: #8B4513;            /* Saddlebrown — shogunal authority */
  --prov-premier: #9B2335;             /* Deep crimson — highest court rank */
  --prov-major: #2B4570;               /* Indigo — ai-iro, samurai class */
  --prov-mid: #5B7B8A;                 /* Steel blue — other daimyō */
  --prov-institution: #6B7B6B;         /* Muted sage — museums, shrines */
  --prov-minor: #8B8178;               /* Warm gray — documented but common */

  /* Alias for backwards compatibility */
  --burgundy: var(--juyo);

  /* Shadows */
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.06);
  --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.08);
  --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.10);
  --shadow-glow: 0 0 32px rgba(184, 134, 11, 0.08);

  /* Legacy aliases for backwards compat */
  --cream: var(--background);
  --ivory: var(--background-warm);
  --linen: var(--surface);
  --paper: var(--surface-elevated);
  --charcoal: var(--text-secondary);
  --ink: var(--text-primary);
  --gold: var(--accent);
  --gold-light: var(--accent-light);
  --muted: var(--text-muted);
  --border-dark: #D4CFC6;
}

/* ==========================================================================
   Dark Mode - Warm scholarly blacks with steel blue accent
   Based on Oshi-v2 Yuhinkai theme
   ========================================================================== */
html.theme-dark,
html.dark {
  color-scheme: dark;

  /* Core palette - Material dark with warmth */
  --background: #121212;
  --background-warm: #171615;
  --foreground: #e8e6e3;

  /* Surfaces - elevation through lightness */
  --surface: #1e1d1c;
  --surface-elevated: #282726;
  --surface-overlay: rgba(30, 29, 28, 0.97);

  /* Borders - warm grays */
  --border: #333231;
  --border-subtle: #242322;
  --border-accent: rgba(93, 138, 168, 0.35);

  /* Interactive states */
  --hover: #2d2c2a;
  --active: #383736;

  /* Primary accent - desaturated steel blue */
  --accent: #5d8aa8;
  --accent-light: #7ba4be;
  --accent-dark: #456a82;
  --accent-glow: rgba(93, 138, 168, 0.18);

  /* Text hierarchy - WCAG compliant contrast */
  --text-primary: #f2f0ed;
  --text-secondary: #b8b4ae;
  --text-tertiary: #8a857f;
  --text-muted: #5c5955;
  --text-accent: #8ab8d8;

  /* Semantic colors - desaturated for dark backgrounds */
  --success: #5a9b7a;
  --warning: #c9a857;
  --error: #c97070;

  /* Button defaults */
  --button-bg: var(--accent);
  --button-bg-hover: var(--accent-dark);
  --button-text: #ffffff;

  /* Certification colors - bright for dark mode contrast */
  --tokuju: #b088d0;
  --tokuju-bg: rgba(176, 136, 208, 0.20);
  --jubi: #F0A830;
  --jubi-bg: rgba(240, 168, 48, 0.18);
  --juyo: #6aace8;
  --juyo-bg: rgba(106, 172, 232, 0.18);
  --toku-hozon: #d4a060;
  --toku-hozon-bg: rgba(212, 160, 96, 0.18);
  --hozon: #d4c850;
  --hozon-bg: rgba(212, 200, 80, 0.18);
  --sage: #a8c990;
  --burgundy: var(--juyo);

  /* New listing badge - bright for dark mode */
  --new-listing: #50d890;
  --new-listing-bg: rgba(80, 216, 144, 0.20);

  /* Artisan confidence colors - bright for dark mode */
  --artisan-high: #50d890;             /* Green - matches new-listing */
  --artisan-high-bg: rgba(80, 216, 144, 0.20);
  --artisan-medium: #e8c860;           /* Yellow/amber - brighter for dark */
  --artisan-medium-bg: rgba(232, 200, 96, 0.18);
  --artisan-low: #888888;              /* Gray - slightly brighter for dark */
  --artisan-low-bg: rgba(136, 136, 136, 0.15);

  /* Provenance tier colors — bright for dark mode */
  --prov-imperial: #D4A030;            /* Bright gold */
  --prov-shogunal: #C07030;            /* Bright saddlebrown */
  --prov-premier: #D04050;             /* Bright crimson */
  --prov-major: #5080C0;               /* Bright indigo */
  --prov-mid: #7898A8;                 /* Bright steel */
  --prov-institution: #88A888;         /* Bright sage */
  --prov-minor: #A89888;               /* Light warm gray */

  /* Shadows - softer for elegance */
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.25);
  --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.35);
  --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.45);
  --shadow-glow: 0 0 32px rgba(93, 138, 168, 0.12);

  /* Legacy aliases - point to dark theme colors */
  --cream: var(--background);
  --ivory: var(--background-warm);
  --linen: var(--surface);
  --paper: var(--surface-elevated);
  --charcoal: var(--text-secondary);
  --ink: var(--text-primary);
  --gold: var(--accent);
  --gold-light: var(--accent-light);
  --muted: var(--text-muted);
  --border-dark: #3a3938;
}

/* ==========================================================================
   OPUS - The Space Between
   Where structure meets emergence, precision finds poetry
   Deep contemplative sapphire with warm amber insights
   ========================================================================== */
html.theme-opus {
  color-scheme: dark;

  /* Void — barely-there blue, near-black depth */
  --background: #020610;
  --background-warm: #060c18;
  --foreground: #e8e4dc;

  /* Layered depths */
  --surface: #08101c;
  --surface-elevated: #0e1824;
  --surface-overlay: rgba(4, 10, 18, 0.97);

  /* Subtle structural lines */
  --border: #162030;
  --border-subtle: #101a24;
  --border-accent: rgba(218, 165, 90, 0.40);

  --hover: #101a24;
  --active: #162030;

  /* Honey gold - deep warm, almost orange */
  --accent: #d49040;
  --accent-light: #e0a858;
  --accent-dark: #b07830;
  --accent-glow: rgba(212, 144, 64, 0.22);

  /* Warm parchment text - readable, human */
  /* WCAG AA requires 4.5:1 contrast for normal text against #020610 background */
  --text-primary: #e8e4dc;
  --text-secondary: #c0b8a8;
  --text-tertiary: #8a8478;
  --text-muted: #8a847c;  /* Lightened from #5a5650 for WCAG AA (~5:1 contrast) */
  --text-accent: #e0a858;

  /* Semantic with warmth */
  --success: #68a878;
  --warning: #d49040;
  --error: #c87070;

  /* Button defaults */
  --button-bg: var(--accent);
  --button-bg-hover: var(--accent-dark);
  --button-text: #ffffff;

  /* Certification colors - warm tints for Opus */
  --tokuju: #c090e0;
  --tokuju-bg: rgba(192, 144, 224, 0.20);
  --jubi: #E8A038;
  --jubi-bg: rgba(232, 160, 56, 0.18);
  --juyo: #70b0e8;
  --juyo-bg: rgba(112, 176, 232, 0.18);
  --toku-hozon: #e0a858;
  --toku-hozon-bg: rgba(224, 168, 88, 0.18);
  --hozon: #e0d048;
  --hozon-bg: rgba(224, 208, 72, 0.18);
  --sage: #a8c890;
  --burgundy: var(--juyo);

  /* New listing badge - warm green for Opus */
  --new-listing: #68c890;
  --new-listing-bg: rgba(104, 200, 144, 0.20);

  /* Provenance tier colors — warm tints for Opus */
  --prov-imperial: #D8A838;
  --prov-shogunal: #B87030;
  --prov-premier: #C84848;
  --prov-major: #5888C8;
  --prov-mid: #7090A0;
  --prov-institution: #809880;
  --prov-minor: #A09080;

  /* Soft contemplative shadows */
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.35);
  --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.45);
  --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.55);
  --shadow-glow: 0 0 40px rgba(212, 144, 64, 0.15);

  /* Legacy aliases */
  --cream: var(--background);
  --ivory: var(--background-warm);
  --linen: var(--surface);
  --paper: var(--surface-elevated);
  --charcoal: var(--text-secondary);
  --ink: var(--text-primary);
  --gold: var(--accent);
  --gold-light: var(--accent-light);
  --muted: var(--text-muted);
  --border-dark: #162030;
}

/* Sothebys - Light mode explicit class */
html.theme-sothebys {
  color-scheme: light;
}

/* ==========================================================================
   Yuhindo Button Overrides
   Forces bg-gold buttons to use rich violet in Yuhindo theme
   ========================================================================== */
html.theme-yuhindo .bg-gold {
  background-color: var(--button-bg) !important;
}

html.theme-yuhindo .bg-gold:hover,
html.theme-yuhindo .hover\:bg-gold-light:hover {
  background-color: var(--button-bg-hover) !important;
}

/* Card header - deep saturated purple instead of grey */
html.theme-yuhindo .dark\:bg-white\/10 {
  background-color: #1a0a28 !important;
}

/* Text gold - actual gold color for "Watch" in logo */
html.theme-yuhindo .text-gold {
  color: var(--gold-accent) !important;
}

/* ==========================================================================
   YUHINDO - The Art of Precious Metal
   Inspired by the legendary tosogu dealer's presentation aesthetic
   Deep velvet blacks, soft lavender light, warm matte gold
   Where shakudo meets silk, and gold whispers from shadow
   ========================================================================== */
html.theme-yuhindo {
  color-scheme: dark;

  /* Core palette - Yuhindo exact colors */
  --background: #010000;
  --background-warm: #04030a;
  --foreground: #ffffff;

  /* Surfaces - deep purple velvet (presentation case feel) */
  --surface: #04020a;
  --surface-elevated: #06040e;
  --surface-overlay: rgba(4, 2, 10, 0.97);

  /* Borders - purple-tinted dark edges */
  --border: #1a1824;
  --border-subtle: #12101a;
  --border-accent: rgba(170, 152, 221, 0.35);

  /* Interactive - subtle shifts */
  --hover: #140c10;
  --active: #1e1418;

  /* Primary accent - Yuhindo lavender for hero text */
  --accent: #aa98dd;
  --accent-light: #c0b0ee;
  --accent-dark: #7c5cb8;
  --accent-glow: rgba(170, 152, 221, 0.18);

  /* Button color - deep violet with white text */
  --button-bg: #4a3670;
  --button-bg-hover: #5a4485;
  --button-text: #ffffff;

  /* Secondary accent - warm matte gold */
  --gold-accent: #c9a040;
  --gold-accent-light: #e0c070;
  --gold-accent-dark: #a08030;

  /* Text hierarchy - white and light grey */
  --text-primary: #ffffff;
  --text-secondary: #b8b8b8;
  --text-tertiary: #888888;
  --text-muted: #555555;
  --text-accent: #aa98dd;

  /* Semantic - tinted to complement the purple palette */
  --success: #70a890;
  --warning: #c9a040;
  --error: #c08080;

  /* Certification colors - jewel tones for Yuhindo
     Rich and saturated like precious stones */
  --tokuju: #c898e0;
  --tokuju-bg: rgba(200, 152, 224, 0.22);
  --jubi: #E8A840;
  --jubi-bg: rgba(232, 168, 64, 0.20);
  --juyo: #90b8e8;
  --juyo-bg: rgba(144, 184, 232, 0.20);
  --toku-hozon: #e0b060;
  --toku-hozon-bg: rgba(224, 176, 96, 0.20);
  --hozon: #d8c860;
  --hozon-bg: rgba(216, 200, 96, 0.20);
  --sage: #98c090;
  --burgundy: #c090b0;

  /* New listing badge - soft mint against the purple */
  --new-listing: #80d0a0;
  --new-listing-bg: rgba(128, 208, 160, 0.20);

  /* Provenance tier colors — jewel tones for Yuhindo */
  --prov-imperial: #D8A840;
  --prov-shogunal: #C07838;
  --prov-premier: #C85060;
  --prov-major: #6898D0;
  --prov-mid: #8098A8;
  --prov-institution: #90A890;
  --prov-minor: #A89890;

  /* Shadows - deep and soft, like velvet folds */
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.45);
  --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.55);
  --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.65);
  --shadow-glow: 0 0 40px rgba(184, 160, 200, 0.12);

  /* Special: plum silk accent for featured elements */
  --silk-plum: #3d2040;
  --silk-plum-light: #4a2850;

  /* Legacy aliases */
  --cream: var(--background);
  --ivory: var(--background-warm);
  --linen: var(--surface);
  --paper: var(--surface-elevated);
  --charcoal: var(--text-secondary);
  --ink: var(--text-primary);
  --gold: var(--gold-accent);
  --gold-light: var(--gold-accent-light);
  --muted: var(--text-muted);
  --border-dark: #2a2436;
}

/* ==========================================================================
   Tailwind Theme Integration
   Maps CSS variables to Tailwind color classes
   ========================================================================== */
@theme inline {
  /* Core colors */
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-surface: var(--surface);
  --color-surface-elevated: var(--surface-elevated);

  /* Legacy names mapped to variables */
  --color-cream: var(--background);
  --color-ivory: var(--background-warm);
  --color-linen: var(--surface);
  --color-paper: var(--surface-elevated);
  --color-charcoal: var(--text-secondary);
  --color-ink: var(--text-primary);

  /* Accent colors */
  --color-gold: var(--accent);
  --color-gold-light: var(--accent-light);
  --color-accent: var(--accent);
  --color-accent-light: var(--accent-light);

  /* Borders */
  --color-border: var(--border);
  --color-border-subtle: var(--border-subtle);
  --color-border-dark: var(--border-dark);

  /* Text */
  --color-muted: var(--text-muted);
  --color-text-primary: var(--text-primary);
  --color-text-secondary: var(--text-secondary);
  --color-text-tertiary: var(--text-tertiary);
  --color-text-muted: var(--text-muted);
  --color-text-accent: var(--text-accent);

  /* Interactive */
  --color-hover: var(--hover);
  --color-active: var(--active);

  /* Status */
  --color-success: var(--success);
  --color-warning: var(--warning);
  --color-error: var(--error);

  /* Certification badges */
  --color-tokuju: var(--tokuju);
  --color-tokuju-bg: var(--tokuju-bg);
  --color-jubi: var(--jubi);
  --color-jubi-bg: var(--jubi-bg);
  --color-juyo: var(--juyo);
  --color-juyo-bg: var(--juyo-bg);
  --color-toku-hozon: var(--toku-hozon);
  --color-toku-hozon-bg: var(--toku-hozon-bg);
  --color-hozon: var(--hozon);
  --color-hozon-bg: var(--hozon-bg);
  --color-sage: var(--sage);
  --color-burgundy: var(--burgundy);

  /* New listing badge */
  --color-new-listing: var(--new-listing);
  --color-new-listing-bg: var(--new-listing-bg);

  /* Artisan confidence badges (admin-only) */
  --color-artisan-high: var(--artisan-high);
  --color-artisan-high-bg: var(--artisan-high-bg);
  --color-artisan-medium: var(--artisan-medium);
  --color-artisan-medium-bg: var(--artisan-medium-bg);
  --color-artisan-low: var(--artisan-low);
  --color-artisan-low-bg: var(--artisan-low-bg);

  /* Yuhindo theme specific */
  --color-silk-plum: var(--silk-plum);
  --color-silk-plum-light: var(--silk-plum-light);
  --color-gold-accent: var(--gold-accent);
  --color-gold-accent-light: var(--gold-accent-light);
  --color-button-bg: var(--button-bg);
  --color-button-bg-hover: var(--button-bg-hover);
  --color-button-text: var(--button-text);

  /* Fonts */
  --font-serif: var(--font-serif);
  --font-sans: var(--font-sans);
}

/* ==========================================================================
   Base Styles
   ========================================================================== */
* {
  box-sizing: border-box;
}

html,
body {
  margin: 0;
  padding: 0;
  height: 100%;
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: var(--font-sans), system-ui, -apple-system, sans-serif;
  font-size: 14px;
  line-height: 1.65;
  font-feature-settings: "kern" 1, "liga" 1;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  transition: background-color 0.3s ease, color 0.3s ease;
}

/* Prevent rubber-band bounce on desktop body scroll only.
   On mobile, the contained scroll div handles scrolling — applying
   overscroll-behavior on body can block iOS Safari touch gestures. */
@media (min-width: 1024px) {
  body {
    overscroll-behavior-y: contain;
  }
}

/* Typography - Scholarly hierarchy */
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-serif), Georgia, "Times New Roman", serif;
  font-weight: 500;
  letter-spacing: -0.02em;
  line-height: 1.25;
  color: var(--text-primary);
}

/* Readable body text */
p, li, td, th {
  letter-spacing: 0.01em;
}

/* ==========================================================================
   Scrollbar
   ========================================================================== */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: var(--background);
}

::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--text-muted);
}

/* ==========================================================================
   Selection
   ========================================================================== */
::selection {
  background: var(--accent-glow);
  color: var(--accent-light);
}

/* ==========================================================================
   Search Input - Hide native clear button (overlaps custom one)
   ========================================================================== */
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration,
input[type="search"]::-webkit-search-results-button,
input[type="search"]::-webkit-search-results-decoration {
  -webkit-appearance: none;
  appearance: none;
  display: none;
}

/* ==========================================================================
   Focus States
   ========================================================================== */
:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

/* ==========================================================================
   Utility Classes
   ========================================================================== */
.font-serif {
  font-family: var(--font-serif), Georgia, "Times New Roman", serif;
}

.font-sans {
  font-family: var(--font-sans), system-ui, -apple-system, sans-serif;
}

/* Japanese text */
.jp {
  font-family: "Hiragino Mincho ProN", "Yu Mincho", "Noto Serif JP", serif;
}

/* Tabular figures for numbers */
.tabular-nums {
  font-variant-numeric: tabular-nums;
}

/* Price display - highly legible */
.price {
  font-family: var(--font-sans), system-ui, -apple-system, sans-serif;
  font-weight: 600;
  font-variant-numeric: tabular-nums;
  letter-spacing: -0.01em;
}

/* Line clamping */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* ==========================================================================
   Translation Prose Styling
   Scholarly typography for setsumei/catalog translations
   ========================================================================== */
.prose-translation {
  font-family: var(--font-serif), Georgia, serif;
  font-size: 14.5px;
  line-height: 1.85;
  color: var(--text-secondary);
  letter-spacing: 0.01em;
}

/* First paragraph - slightly larger for emphasis */
.prose-translation > p:first-of-type {
  font-size: 15px;
}

/* Title header with underline */
.prose-translation h1 {
  font-size: 16px;
  font-weight: 500;
  color: var(--text-primary);
  margin-top: 0;
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid var(--border);
}

/* Section headers */
.prose-translation h2 {
  font-size: 14px;
  font-weight: 500;
  color: var(--text-primary);
  margin-top: 1.75rem;
  margin-bottom: 0.75rem;
}

/* Subsection headers */
.prose-translation h3 {
  font-size: 13px;
  font-weight: 500;
  color: var(--text-primary);
  margin-top: 1.25rem;
  margin-bottom: 0.5rem;
}

/* Paragraphs with generous spacing */
.prose-translation p {
  margin-bottom: 1.25rem;
}

/* Remove margin from last paragraph */
.prose-translation p:last-child {
  margin-bottom: 0;
}

/* Lists */
.prose-translation ul {
  margin: 1rem 0;
  padding-left: 1.25rem;
  list-style-type: disc;
}

.prose-translation ol {
  margin: 1rem 0;
  padding-left: 1.25rem;
  list-style-type: decimal;
}

.prose-translation li {
  margin: 0.5rem 0;
}

.prose-translation li::marker {
  color: var(--text-muted);
}

/* Bold text - primary color for emphasis */
.prose-translation strong {
  font-weight: 600;
  color: var(--text-primary);
}

/* Blockquotes - elegant left border */
.prose-translation blockquote {
  border-left: 2px solid var(--accent);
  padding-left: 1rem;
  margin: 1rem 0;
  color: var(--text-muted);
  font-style: italic;
}

/* Horizontal rules */
.prose-translation hr {
  margin: 1.5rem 0;
  border: none;
  border-top: 1px solid var(--border);
}

/* Tables */
.prose-translation table {
  width: 100%;
  border-collapse: collapse;
  font-size: 13px;
  margin: 1rem 0;
}

.prose-translation th,
.prose-translation td {
  border: 1px solid var(--border);
  padding: 0.5rem 0.75rem;
  text-align: left;
}

.prose-translation th {
  background: var(--surface-elevated);
  font-weight: 500;
  color: var(--text-primary);
}

/* Links */
.prose-translation a {
  color: var(--accent);
  text-decoration: none;
}

.prose-translation a:hover {
  text-decoration: underline;
}

/* ==========================================================================
   Card Styles
   ========================================================================== */
.card-hover {
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
}

.card-hover:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

/* ==========================================================================
   Badge Styles
   ========================================================================== */
.badge {
  display: inline-flex;
  align-items: center;
  padding: 0.2rem 0.5rem;
  font-size: 0.65rem;
  font-weight: 500;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.badge-juyo {
  background: var(--juyo);
  color: white;
}

.badge-toku-hozon {
  background: var(--toku-hozon);
  color: white;
}

.badge-hozon {
  background: var(--hozon);
  color: white;
}

.badge-available {
  background: var(--sage);
  color: white;
}

.badge-sold {
  background: var(--text-muted);
  color: white;
}

/* ==========================================================================
   Button Styles
   ========================================================================== */
.btn-elegant {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.625rem 1.25rem;
  font-size: 0.7rem;
  font-weight: 500;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  background: var(--surface-elevated);
  color: var(--text-primary);
  border: 1px solid var(--border);
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn-elegant:hover {
  background: var(--hover);
  border-color: var(--accent);
}

.btn-outline {
  background: transparent;
  color: var(--text-primary);
  border: 1px solid var(--border);
}

.btn-outline:hover {
  background: var(--accent);
  color: var(--background);
  border-color: var(--accent);
}

/* ==========================================================================
   Divider
   ========================================================================== */
.divider {
  height: 1px;
  background: linear-gradient(
    to right,
    transparent,
    var(--border),
    transparent
  );
}

/* ==========================================================================
   Loading States
   ========================================================================== */
.img-loading {
  background: linear-gradient(
    110deg,
    var(--surface) 8%,
    var(--surface-elevated) 18%,
    var(--surface) 33%
  );
  background-size: 200% 100%;
  animation: shimmer 1.5s linear infinite;
}

@keyframes shimmer {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

.animate-shimmer {
  background-size: 200% 100%;
  animation: shimmer 1.5s ease-in-out infinite;
}

/* ==========================================================================
   Animations
   ========================================================================== */
@keyframes slideUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}

.animate-slideUp {
  animation: slideUp 0.3s cubic-bezier(0.32, 0.72, 0, 1);
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.animate-fadeIn {
  animation: fadeIn 0.2s ease-out;
}

@keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

.animate-fadeOut {
  animation: fadeOut 0.3s ease-out forwards;
}

@keyframes slideDown {
  from {
    transform: translateY(0);
  }
  to {
    transform: translateY(100%);
  }
}

.animate-slideDown {
  animation: slideDown 0.3s cubic-bezier(0.32, 0.72, 0, 1) forwards;
}

/* ==========================================================================
   Mobile Specific
   ========================================================================== */
.safe-area-bottom {
  padding-bottom: env(safe-area-inset-bottom, 0px);
}

.safe-area-top {
  padding-top: env(safe-area-inset-top, 0px);
}

/* Drawer open state - overflow hidden WITHOUT position:fixed
   Using position:fixed breaks fixed children (BottomTabBar) */
body.drawer-open {
  overflow: hidden;
  /* NO position:fixed - this preserves coordinate system for fixed children */
}

.overscroll-contain {
  overscroll-behavior: contain;
}

/* Touch-friendly tap highlight */
@media (hover: none) {
  button, a, label {
    -webkit-tap-highlight-color: var(--accent-glow);
  }
}

/* Disable hover effects on touch devices */
@media (hover: none) and (pointer: coarse) {
  .card-hover:hover {
    transform: none;
    box-shadow: none;
  }
}

/* Mobile-friendly text sizes */
@media (max-width: 640px) {
  body {
    font-size: 13px;
  }
}

/* Custom toggle switch track position fix */
.translate-x-4\.5 {
  transform: translateX(1.125rem);
}

/* ==========================================================================
   Mobile Bottom Sheet
   ========================================================================== */
.sheet-expanded {
  max-height: 50vh;
}

.sheet-collapsed {
  max-height: 48px;
}

@keyframes bounce-subtle {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-3px);
  }
}

.animate-bounce-subtle {
  animation: bounce-subtle 1.5s ease-in-out infinite;
}

/* Slide-up reveal for enrichment section */
@keyframes slideUpReveal {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-slideUpReveal {
  animation: slideUpReveal 300ms ease-out forwards;
}

/* ==========================================================================
   Magical Book Icon - Study Setsumei Button
   Floating effect with warm golden aura pulse
   ========================================================================== */
@keyframes float {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-3px);
  }
}

@keyframes glowPulse {
  0%, 100% {
    box-shadow: 0 0 8px 2px rgba(184, 134, 11, 0.25),
                0 0 16px 4px rgba(184, 134, 11, 0.15);
  }
  50% {
    box-shadow: 0 0 12px 4px rgba(184, 134, 11, 0.4),
                0 0 24px 8px rgba(184, 134, 11, 0.2);
  }
}

/* Combined floating + glowing effect */
.magical-book {
  animation:
    float 3s ease-in-out infinite,
    glowPulse 2.5s ease-in-out infinite;
  background: linear-gradient(135deg, rgba(184, 134, 11, 0.15) 0%, rgba(212, 175, 55, 0.1) 100%);
  border: 1px solid rgba(184, 134, 11, 0.3);
  color: var(--accent);
}

.magical-book:hover {
  animation:
    float 3s ease-in-out infinite,
    glowPulse 1.5s ease-in-out infinite;
  box-shadow: 0 0 16px 6px rgba(184, 134, 11, 0.5),
              0 0 32px 12px rgba(184, 134, 11, 0.25);
  background: linear-gradient(135deg, rgba(184, 134, 11, 0.25) 0%, rgba(212, 175, 55, 0.15) 100%);
  border-color: rgba(184, 134, 11, 0.5);
  transform: scale(1.05);
}

/* Dark mode adjustments - use theme accent color */
html.dark .magical-book,
html.theme-dark .magical-book,
html.theme-opus .magical-book,
html.theme-yuhindo .magical-book {
  background: linear-gradient(135deg, var(--accent-glow) 0%, rgba(var(--accent), 0.1) 100%);
  border-color: rgba(255, 255, 255, 0.15);
  box-shadow: 0 0 8px 2px var(--accent-glow),
              0 0 16px 4px rgba(255, 255, 255, 0.05);
}

html.dark .magical-book:hover,
html.theme-dark .magical-book:hover,
html.theme-opus .magical-book:hover,
html.theme-yuhindo .magical-book:hover {
  box-shadow: 0 0 16px 6px var(--accent-glow),
              0 0 32px 12px rgba(255, 255, 255, 0.1);
}

/* ==========================================================================
   Mobile Scroll Stability
   Prevents bouncing/jank during infinite scroll load more
   ========================================================================== */

/* DISABLE CSS scroll anchoring for virtualized containers
   Browser anchoring conflicts with our virtualization which already
   manages scroll position. The container height is pre-calculated
   from totalCount, so we don't need browser anchoring. */
.virtual-scroll-container {
  overflow-anchor: none;
  /* iOS Safari scroll stability - prevent rubber-band during height changes */
  overscroll-behavior-y: contain;
  -webkit-overflow-scrolling: touch;
}

/* Prevent overscroll bounce during content changes on mobile */
.scroll-stable {
  overscroll-behavior-y: contain;
}

/* Fixed-height loading indicator zone to prevent layout shifts */
.load-more-placeholder {
  height: 64px;
  min-height: 64px;
}

/* iOS Safari virtualization - use native content-visibility instead of JS transform.
   This avoids the transform glitches that cause cards to "teleport" on iOS.
   The --card-intrinsic-height custom property is set by VirtualListingGrid from the
   shared cardHeight.ts module — single source of truth for card dimensions. */
@supports (content-visibility: auto) {
  .ios-native-virtualize > * {
    content-visibility: auto;
    contain-intrinsic-block-size: auto var(--card-intrinsic-height, 450px);
  }
}

/* ==========================================================================
   Legal Content Styles
   Typography for Terms, Privacy, and Cookie Policy pages
   ========================================================================== */

.legal-content {
  color: var(--text-primary);
  line-height: 1.7;
}

.legal-content h1 {
  font-family: var(--font-serif);
  font-size: 2rem;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 0.5rem;
  line-height: 1.2;
}

.legal-content > p:first-of-type {
  color: var(--text-muted);
  font-size: 0.875rem;
  margin-bottom: 2rem;
}

.legal-content h2 {
  font-family: var(--font-serif);
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--text-primary);
  margin-top: 2.5rem;
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid var(--border);
}

.legal-content h3 {
  font-family: var(--font-serif);
  font-size: 1.125rem;
  font-weight: 600;
  color: var(--text-primary);
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
}

.legal-content p {
  margin-bottom: 1rem;
  color: var(--text-primary);
}

.legal-content ul,
.legal-content ol {
  margin-bottom: 1rem;
  padding-left: 1.5rem;
  color: var(--text-primary);
}

.legal-content li {
  margin-bottom: 0.5rem;
}

.legal-content a {
  color: var(--accent);
  text-decoration: none;
  transition: color 0.2s ease;
}

.legal-content a:hover {
  text-decoration: underline;
}

.legal-content strong {
  font-weight: 600;
  color: var(--text-primary);
}

.legal-content table {
  width: 100%;
  margin: 1.5rem 0;
  border-collapse: collapse;
  font-size: 0.875rem;
}

.legal-content th,
.legal-content td {
  padding: 0.75rem 1rem;
  text-align: left;
  border: 1px solid var(--border);
}

.legal-content th {
  background: var(--surface);
  font-weight: 600;
  color: var(--text-primary);
}

.legal-content td {
  color: var(--text-primary);
}

.legal-content blockquote {
  margin: 1.5rem 0;
  padding: 1rem 1.5rem;
  background: var(--surface);
  border-left: 3px solid var(--accent);
  color: var(--text-primary);
}

.legal-content hr {
  margin: 2rem 0;
  border: none;
  border-top: 1px solid var(--border);
}

/* ==========================================================================
   Collection Form Utilities
   ========================================================================== */

.form-input {
  display: block;
  width: 100%;
  padding: 0.5rem 0.75rem;
  font-size: 13px;
  color: var(--text-primary);
  background: var(--surface-elevated);
  border: 1px solid var(--border);
  border-radius: 0.375rem;
  transition: border-color 0.15s;
}

.form-input:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 1px var(--accent);
}

.form-input::placeholder {
  color: var(--text-muted);
  opacity: 0.5;
}

.form-select {
  display: block;
  width: 100%;
  padding: 0.5rem 0.75rem;
  font-size: 13px;
  color: var(--text-primary);
  background: var(--surface-elevated);
  border: 1px solid var(--border);
  border-radius: 0.375rem;
  cursor: pointer;
  transition: border-color 0.15s;
}

.form-select:focus {
  outline: none;
  border-color: var(--accent);
}

/* Slide-in from right animation for QuickView panel */
@keyframes slideInRight {
  from { transform: translateX(100%); }
  to { transform: translateX(0); }
}

.animate-slide-in-right {
  animation: slideInRight 0.3s ease-out;
}
