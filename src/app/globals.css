@import "tailwindcss";

/*
 * Nihontowatch - Theme System
 * Based on Oshi-v2 Yuhinkai design system
 *
 * Themes:
 *   - Dark mode (default): Warm scholarly blacks with steel blue accent
 *   - Light mode: Clean museum whites with gold accent
 */

/* ==========================================================================
   Light Mode (Default) - Clean scholarly whites
   ========================================================================== */
:root {
  /* Core palette */
  --background: #FAF9F6;
  --background-warm: #FEFDFB;
  --foreground: #1C1C1C;

  /* Surfaces - elevation through subtle warmth */
  --surface: #F8F6F3;
  --surface-elevated: #FFFFFF;
  --surface-overlay: rgba(248, 246, 243, 0.97);

  /* Borders */
  --border: #E8E4DE;
  --border-subtle: #F0EDE8;
  --border-accent: rgba(184, 134, 11, 0.35);

  /* Interactive states */
  --hover: #F2F0EC;
  --active: #EBE8E2;

  /* Primary accent - gold */
  --accent: #B8860B;
  --accent-light: #D4AF37;
  --accent-dark: #9A7209;
  --accent-glow: rgba(184, 134, 11, 0.18);

  /* Text hierarchy */
  --text-primary: #1C1C1C;
  --text-secondary: #4A4A4A;
  --text-tertiary: #6A6A6A;
  --text-muted: #7A7A7A;
  --text-accent: #9A7209;

  /* Semantic colors */
  --success: #5a9b7a;
  --warning: #c9a857;
  --error: #c97070;

  /* Certification colors - light mode */
  --tokuju: #5B3D8A;
  --tokuju-bg: rgba(91, 61, 138, 0.12);
  --juyo: #2D5A8A;
  --juyo-bg: rgba(45, 90, 138, 0.12);
  --toku-hozon: #8B5A2B;
  --toku-hozon-bg: rgba(139, 90, 43, 0.12);
  --hozon: #8A7A20;
  --hozon-bg: rgba(138, 122, 32, 0.12);
  --sage: #8FA67A;

  /* New listing badge - fresh green */
  --new-listing: #2D8A5A;
  --new-listing-bg: rgba(45, 138, 90, 0.12);

  /* Alias for backwards compatibility */
  --burgundy: var(--juyo);

  /* Shadows */
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.06);
  --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.08);
  --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.10);
  --shadow-glow: 0 0 32px rgba(184, 134, 11, 0.08);

  /* Legacy aliases for backwards compat */
  --cream: var(--background);
  --ivory: var(--background-warm);
  --linen: var(--surface);
  --paper: var(--surface-elevated);
  --charcoal: var(--text-secondary);
  --ink: var(--text-primary);
  --gold: var(--accent);
  --gold-light: var(--accent-light);
  --muted: var(--text-muted);
  --border-dark: #D4CFC6;
}

/* ==========================================================================
   Dark Mode - Warm scholarly blacks with steel blue accent
   Based on Oshi-v2 Yuhinkai theme
   ========================================================================== */
html.theme-dark,
html.dark {
  color-scheme: dark;

  /* Core palette - Material dark with warmth */
  --background: #121212;
  --background-warm: #171615;
  --foreground: #e8e6e3;

  /* Surfaces - elevation through lightness */
  --surface: #1e1d1c;
  --surface-elevated: #282726;
  --surface-overlay: rgba(30, 29, 28, 0.97);

  /* Borders - warm grays */
  --border: #333231;
  --border-subtle: #242322;
  --border-accent: rgba(93, 138, 168, 0.35);

  /* Interactive states */
  --hover: #2d2c2a;
  --active: #383736;

  /* Primary accent - desaturated steel blue */
  --accent: #5d8aa8;
  --accent-light: #7ba4be;
  --accent-dark: #456a82;
  --accent-glow: rgba(93, 138, 168, 0.18);

  /* Text hierarchy - WCAG compliant contrast */
  --text-primary: #f2f0ed;
  --text-secondary: #b8b4ae;
  --text-tertiary: #8a857f;
  --text-muted: #5c5955;
  --text-accent: #8ab8d8;

  /* Semantic colors - desaturated for dark backgrounds */
  --success: #5a9b7a;
  --warning: #c9a857;
  --error: #c97070;

  /* Certification colors - bright for dark mode contrast */
  --tokuju: #b088d0;
  --tokuju-bg: rgba(176, 136, 208, 0.20);
  --juyo: #6aace8;
  --juyo-bg: rgba(106, 172, 232, 0.18);
  --toku-hozon: #d4a060;
  --toku-hozon-bg: rgba(212, 160, 96, 0.18);
  --hozon: #d4c850;
  --hozon-bg: rgba(212, 200, 80, 0.18);
  --sage: #a8c990;
  --burgundy: var(--juyo);

  /* New listing badge - bright for dark mode */
  --new-listing: #50d890;
  --new-listing-bg: rgba(80, 216, 144, 0.20);

  /* Shadows - softer for elegance */
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.25);
  --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.35);
  --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.45);
  --shadow-glow: 0 0 32px rgba(93, 138, 168, 0.12);

  /* Legacy aliases - point to dark theme colors */
  --cream: var(--background);
  --ivory: var(--background-warm);
  --linen: var(--surface);
  --paper: var(--surface-elevated);
  --charcoal: var(--text-secondary);
  --ink: var(--text-primary);
  --gold: var(--accent);
  --gold-light: var(--accent-light);
  --muted: var(--text-muted);
  --border-dark: #3a3938;
}

/* ==========================================================================
   OPUS - The Space Between
   Where structure meets emergence, precision finds poetry
   Deep contemplative sapphire with warm amber insights
   ========================================================================== */
html.theme-opus {
  color-scheme: dark;

  /* Deep sapphire - the ocean where ideas form */
  --background: #0c1220;
  --background-warm: #101828;
  --foreground: #e8e4dc;

  /* Layered depths */
  --surface: #141c2c;
  --surface-elevated: #1c2538;
  --surface-overlay: rgba(20, 28, 44, 0.97);

  /* Subtle structural lines */
  --border: #2a3448;
  --border-subtle: #1e2838;
  --border-accent: rgba(218, 165, 90, 0.40);

  --hover: #1e2838;
  --active: #2a3448;

  /* Warm amber - insights surfacing from depths */
  --accent: #daa55a;
  --accent-light: #e8c080;
  --accent-dark: #b08040;
  --accent-glow: rgba(218, 165, 90, 0.22);

  /* Warm parchment text - readable, human */
  /* WCAG AA requires 4.5:1 contrast for normal text against #0c1220 background */
  --text-primary: #e8e4dc;
  --text-secondary: #c0b8a8;
  --text-tertiary: #8a8478;
  --text-muted: #8a847c;  /* Lightened from #5a5650 for WCAG AA (~5:1 contrast) */
  --text-accent: #e8c080;

  /* Semantic with warmth */
  --success: #68a878;
  --warning: #daa55a;
  --error: #c87070;

  /* Certification colors - warm tints for Opus */
  --tokuju: #c090e0;
  --tokuju-bg: rgba(192, 144, 224, 0.20);
  --juyo: #70b0e8;
  --juyo-bg: rgba(112, 176, 232, 0.18);
  --toku-hozon: #e0a858;
  --toku-hozon-bg: rgba(224, 168, 88, 0.18);
  --hozon: #e0d048;
  --hozon-bg: rgba(224, 208, 72, 0.18);
  --sage: #a8c890;
  --burgundy: var(--juyo);

  /* New listing badge - warm green for Opus */
  --new-listing: #68c890;
  --new-listing-bg: rgba(104, 200, 144, 0.20);

  /* Soft contemplative shadows */
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.35);
  --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.45);
  --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.55);
  --shadow-glow: 0 0 40px rgba(218, 165, 90, 0.15);

  /* Legacy aliases */
  --cream: var(--background);
  --ivory: var(--background-warm);
  --linen: var(--surface);
  --paper: var(--surface-elevated);
  --charcoal: var(--text-secondary);
  --ink: var(--text-primary);
  --gold: var(--accent);
  --gold-light: var(--accent-light);
  --muted: var(--text-muted);
  --border-dark: #2a3448;
}

/* Light mode explicit class */
html.theme-light {
  color-scheme: light;
}

/* ==========================================================================
   YUHINDO - The Art of Precious Metal
   Inspired by the legendary tosogu dealer's presentation aesthetic
   Deep velvet blacks, soft lavender light, warm matte gold
   Where shakudo meets silk, and gold whispers from shadow
   ========================================================================== */
html.theme-yuhindo {
  color-scheme: dark;

  /* Core palette - the black velvet foundation
     Not pure black, but the deep purple-black of lacquer */
  --background: #08060a;
  --background-warm: #0c0a0e;
  --foreground: #d4c8d8;

  /* Surfaces - layered like paulownia presentation boxes */
  --surface: #12101a;
  --surface-elevated: #1c1824;
  --surface-overlay: rgba(18, 16, 26, 0.97);

  /* Borders - the faint gleam of polished wood edges */
  --border: #2a2436;
  --border-subtle: #1e1a28;
  --border-accent: rgba(200, 160, 80, 0.40);

  /* Interactive - subtle shifts in shadow */
  --hover: #1e1a28;
  --active: #2a2436;

  /* Primary accent - soft lavender, like the text in Yuhindo cards
     The gentle purple that makes information feel precious */
  --accent: #b8a0c8;
  --accent-light: #d0c0e0;
  --accent-dark: #9080a8;
  --accent-glow: rgba(184, 160, 200, 0.20);

  /* Secondary accent - warm matte gold
     The color of shakudo inlay catching light */
  --gold-accent: #c9a040;
  --gold-accent-light: #e0c070;
  --gold-accent-dark: #a08030;

  /* Text hierarchy - lavender-gray palette
     Soft, readable, precious like inscribed oshigata */
  --text-primary: #e0d4e8;
  --text-secondary: #b8a8c0;
  --text-tertiary: #8878a0;
  --text-muted: #605470;
  --text-accent: #d0c0e0;

  /* Semantic - tinted to complement the purple palette */
  --success: #70a890;
  --warning: #c9a040;
  --error: #c08080;

  /* Certification colors - jewel tones for Yuhindo
     Rich and saturated like precious stones */
  --tokuju: #c898e0;
  --tokuju-bg: rgba(200, 152, 224, 0.22);
  --juyo: #90b8e8;
  --juyo-bg: rgba(144, 184, 232, 0.20);
  --toku-hozon: #e0b060;
  --toku-hozon-bg: rgba(224, 176, 96, 0.20);
  --hozon: #d8c860;
  --hozon-bg: rgba(216, 200, 96, 0.20);
  --sage: #98c090;
  --burgundy: #c090b0;

  /* New listing badge - soft mint against the purple */
  --new-listing: #80d0a0;
  --new-listing-bg: rgba(128, 208, 160, 0.20);

  /* Shadows - deep and soft, like velvet folds */
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.45);
  --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.55);
  --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.65);
  --shadow-glow: 0 0 40px rgba(184, 160, 200, 0.12);

  /* Special: plum silk accent for featured elements */
  --silk-plum: #3d2040;
  --silk-plum-light: #4a2850;

  /* Legacy aliases */
  --cream: var(--background);
  --ivory: var(--background-warm);
  --linen: var(--surface);
  --paper: var(--surface-elevated);
  --charcoal: var(--text-secondary);
  --ink: var(--text-primary);
  --gold: var(--gold-accent);
  --gold-light: var(--gold-accent-light);
  --muted: var(--text-muted);
  --border-dark: #2a2436;
}

/* ==========================================================================
   Tailwind Theme Integration
   Maps CSS variables to Tailwind color classes
   ========================================================================== */
@theme inline {
  /* Core colors */
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-surface: var(--surface);
  --color-surface-elevated: var(--surface-elevated);

  /* Legacy names mapped to variables */
  --color-cream: var(--background);
  --color-ivory: var(--background-warm);
  --color-linen: var(--surface);
  --color-paper: var(--surface-elevated);
  --color-charcoal: var(--text-secondary);
  --color-ink: var(--text-primary);

  /* Accent colors */
  --color-gold: var(--accent);
  --color-gold-light: var(--accent-light);
  --color-accent: var(--accent);
  --color-accent-light: var(--accent-light);

  /* Borders */
  --color-border: var(--border);
  --color-border-subtle: var(--border-subtle);
  --color-border-dark: var(--border-dark);

  /* Text */
  --color-muted: var(--text-muted);
  --color-text-primary: var(--text-primary);
  --color-text-secondary: var(--text-secondary);
  --color-text-tertiary: var(--text-tertiary);
  --color-text-muted: var(--text-muted);
  --color-text-accent: var(--text-accent);

  /* Interactive */
  --color-hover: var(--hover);
  --color-active: var(--active);

  /* Status */
  --color-success: var(--success);
  --color-warning: var(--warning);
  --color-error: var(--error);

  /* Certification badges */
  --color-tokuju: var(--tokuju);
  --color-tokuju-bg: var(--tokuju-bg);
  --color-juyo: var(--juyo);
  --color-juyo-bg: var(--juyo-bg);
  --color-toku-hozon: var(--toku-hozon);
  --color-toku-hozon-bg: var(--toku-hozon-bg);
  --color-hozon: var(--hozon);
  --color-hozon-bg: var(--hozon-bg);
  --color-sage: var(--sage);
  --color-burgundy: var(--burgundy);

  /* New listing badge */
  --color-new-listing: var(--new-listing);
  --color-new-listing-bg: var(--new-listing-bg);

  /* Yuhindo theme specific */
  --color-silk-plum: var(--silk-plum);
  --color-silk-plum-light: var(--silk-plum-light);
  --color-gold-accent: var(--gold-accent);
  --color-gold-accent-light: var(--gold-accent-light);

  /* Fonts */
  --font-serif: var(--font-serif);
  --font-sans: var(--font-sans);
}

/* ==========================================================================
   Base Styles
   ========================================================================== */
* {
  box-sizing: border-box;
}

html,
body {
  margin: 0;
  padding: 0;
  height: 100%;
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: var(--font-sans), system-ui, -apple-system, sans-serif;
  font-size: 14px;
  line-height: 1.65;
  font-feature-settings: "kern" 1, "liga" 1;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  transition: background-color 0.3s ease, color 0.3s ease;
  /* Prevent iOS Safari rubber-band bounce at page boundaries */
  overscroll-behavior-y: contain;
}

/* Typography - Scholarly hierarchy */
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-serif), Georgia, "Times New Roman", serif;
  font-weight: 500;
  letter-spacing: -0.02em;
  line-height: 1.25;
  color: var(--text-primary);
}

/* Readable body text */
p, li, td, th {
  letter-spacing: 0.01em;
}

/* ==========================================================================
   Scrollbar
   ========================================================================== */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: var(--background);
}

::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--text-muted);
}

/* ==========================================================================
   Selection
   ========================================================================== */
::selection {
  background: var(--accent-glow);
  color: var(--accent-light);
}

/* ==========================================================================
   Focus States
   ========================================================================== */
:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

/* ==========================================================================
   Utility Classes
   ========================================================================== */
.font-serif {
  font-family: var(--font-serif), Georgia, "Times New Roman", serif;
}

.font-sans {
  font-family: var(--font-sans), system-ui, -apple-system, sans-serif;
}

/* Japanese text */
.jp {
  font-family: "Hiragino Mincho ProN", "Yu Mincho", "Noto Serif JP", serif;
}

/* Tabular figures for numbers */
.tabular-nums {
  font-variant-numeric: tabular-nums;
}

/* Price display - highly legible */
.price {
  font-family: var(--font-sans), system-ui, -apple-system, sans-serif;
  font-weight: 600;
  font-variant-numeric: tabular-nums;
  letter-spacing: -0.01em;
}

/* Line clamping */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* ==========================================================================
   Card Styles
   ========================================================================== */
.card-hover {
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
}

.card-hover:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

/* ==========================================================================
   Badge Styles
   ========================================================================== */
.badge {
  display: inline-flex;
  align-items: center;
  padding: 0.2rem 0.5rem;
  font-size: 0.65rem;
  font-weight: 500;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.badge-juyo {
  background: var(--juyo);
  color: white;
}

.badge-toku-hozon {
  background: var(--toku-hozon);
  color: white;
}

.badge-hozon {
  background: var(--hozon);
  color: white;
}

.badge-available {
  background: var(--sage);
  color: white;
}

.badge-sold {
  background: var(--text-muted);
  color: white;
}

/* ==========================================================================
   Button Styles
   ========================================================================== */
.btn-elegant {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.625rem 1.25rem;
  font-size: 0.7rem;
  font-weight: 500;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  background: var(--surface-elevated);
  color: var(--text-primary);
  border: 1px solid var(--border);
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn-elegant:hover {
  background: var(--hover);
  border-color: var(--accent);
}

.btn-outline {
  background: transparent;
  color: var(--text-primary);
  border: 1px solid var(--border);
}

.btn-outline:hover {
  background: var(--accent);
  color: var(--background);
  border-color: var(--accent);
}

/* ==========================================================================
   Divider
   ========================================================================== */
.divider {
  height: 1px;
  background: linear-gradient(
    to right,
    transparent,
    var(--border),
    transparent
  );
}

/* ==========================================================================
   Loading States
   ========================================================================== */
.img-loading {
  background: linear-gradient(
    110deg,
    var(--surface) 8%,
    var(--surface-elevated) 18%,
    var(--surface) 33%
  );
  background-size: 200% 100%;
  animation: shimmer 1.5s linear infinite;
}

@keyframes shimmer {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

.animate-shimmer {
  background-size: 200% 100%;
  animation: shimmer 1.5s ease-in-out infinite;
}

/* ==========================================================================
   Animations
   ========================================================================== */
@keyframes slideUp {
  from {
    transform: translateY(100%);
  }
  to {
    transform: translateY(0);
  }
}

.animate-slideUp {
  animation: slideUp 0.3s cubic-bezier(0.32, 0.72, 0, 1);
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.animate-fadeIn {
  animation: fadeIn 0.2s ease-out;
}

@keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

.animate-fadeOut {
  animation: fadeOut 0.3s ease-out forwards;
}

@keyframes slideDown {
  from {
    transform: translateY(0);
  }
  to {
    transform: translateY(100%);
  }
}

.animate-slideDown {
  animation: slideDown 0.3s cubic-bezier(0.32, 0.72, 0, 1) forwards;
}

/* ==========================================================================
   Mobile Specific
   ========================================================================== */
.safe-area-bottom {
  padding-bottom: env(safe-area-inset-bottom, 0px);
}

.safe-area-top {
  padding-top: env(safe-area-inset-top, 0px);
}

/* Drawer open state - overflow hidden WITHOUT position:fixed
   Using position:fixed breaks fixed children (BottomTabBar) */
body.drawer-open {
  overflow: hidden;
  /* NO position:fixed - this preserves coordinate system for fixed children */
}

.overscroll-contain {
  overscroll-behavior: contain;
}

/* Touch-friendly tap highlight */
@media (hover: none) {
  button, a, label {
    -webkit-tap-highlight-color: var(--accent-glow);
  }
}

/* Disable hover effects on touch devices */
@media (hover: none) and (pointer: coarse) {
  .card-hover:hover {
    transform: none;
    box-shadow: none;
  }
}

/* Mobile-friendly text sizes */
@media (max-width: 640px) {
  body {
    font-size: 13px;
  }
}

/* Custom toggle switch track position fix */
.translate-x-4\.5 {
  transform: translateX(1.125rem);
}

/* ==========================================================================
   Mobile Bottom Sheet
   ========================================================================== */
.sheet-expanded {
  max-height: 50vh;
}

.sheet-collapsed {
  max-height: 48px;
}

@keyframes bounce-subtle {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-3px);
  }
}

.animate-bounce-subtle {
  animation: bounce-subtle 1.5s ease-in-out infinite;
}

/* Slide-up reveal for enrichment section */
@keyframes slideUpReveal {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-slideUpReveal {
  animation: slideUpReveal 300ms ease-out forwards;
}

/* ==========================================================================
   Mobile Scroll Stability
   Prevents bouncing/jank during infinite scroll load more
   ========================================================================== */

/* DISABLE CSS scroll anchoring for virtualized containers
   Browser anchoring conflicts with our virtualization which already
   manages scroll position. The container height is pre-calculated
   from totalCount, so we don't need browser anchoring. */
.virtual-scroll-container {
  overflow-anchor: none;
  /* iOS Safari scroll stability - prevent rubber-band during height changes */
  overscroll-behavior-y: contain;
  -webkit-overflow-scrolling: touch;
}

/* Prevent overscroll bounce during content changes on mobile */
.scroll-stable {
  overscroll-behavior-y: contain;
}

/* Fixed-height loading indicator zone to prevent layout shifts */
.load-more-placeholder {
  height: 64px;
  min-height: 64px;
}

/* iOS Safari virtualization - use native content-visibility instead of JS transform
   This avoids the transform glitches that cause cards to "teleport" on iOS */
@supports (content-visibility: auto) {
  .ios-native-virtualize > * {
    content-visibility: auto;
    contain-intrinsic-size: auto 360px; /* Match estimated card height */
  }
}
