# Session: Fix Incorrect Mei/Signature Distribution on Artist Profiles

**Date:** 2026-02-09
**Issue:** Artist profile pages for Chogi (CHO10) and Masamune (MAS590) showed wildly incorrect signature distributions — e.g., Chogi showed 89% "Signed (mei)" when most works are mumei (unsigned).

## Root Cause

The `artist_profiles.stats_snapshot` column contained stale, incorrect mei distribution data for 2 profiles. These snapshots were generated by an earlier process with a different algorithm that produced nonsensical numbers:

| Smith | Snapshot (wrong) | Live query (correct) |
|-------|-------------------|----------------------|
| Chogi (CHO10) | signed: 111, mumei: 0 | signed: 34, mumei: 71 |
| Masamune (MAS590) | signed: 99, mumei: 0 | signed: 8, mumei: 60 |

The code in both `page.tsx` and the API route preferred the cached snapshot over the live `getArtisanDistributions()` query, so the bad data was served.

## Fixes

### Database (immediate)
- Nulled `stats_snapshot` for CHO10 and MAS590 in `artist_profiles` table
- These were the only 2 profiles with snapshots

### Code (prevents recurrence)
- **`src/app/artists/[slug]/page.tsx`**: Removed snapshot-first logic, always calls `getArtisanDistributions()` live
- **`src/app/api/artisan/[code]/route.ts`**: Same — removed snapshot preference, added `getArtisanDistributions` import, calls live query

## Validation

### Underlying data quality audit
Spot-checked 16 well-known smiths/schools across all periods. The live `gold_mei_status` data in `gold_values` is correct:

- **Koto mumei-heavy smiths** (Sadamune, Yukimitsu, Norishige, Masamune): all show mumei as dominant
- **Schools** (Ichimonji, Aoe, Taima): all show mumei as dominant
- **Shinto/Shinshinto signed-heavy** (Kunihiro, Tadahiro, Tadayoshi, Sukehiro, Kunisada): all show signed as dominant
- **Mixed** (Kunimitsu, Nagamitsu, Kanemitsu): plausible distributions

### Production verification
Fetched live pages after fix — both now show correct data:
- Chogi: Mumei 62%, Signed 30%, Kinzogan 5%
- Masamune: Mumei 63%, Signed 8%, Kinzogan 17%

## Files Changed
- `src/app/artists/[slug]/page.tsx` — remove snapshot preference for stats
- `src/app/api/artisan/[code]/route.ts` — remove snapshot preference, add live query import
